
my $pdb_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/1RU7_mod.txt";
my $distance_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/1RU7_mod_distances.txt";
open PDB, "<$pdb_file";

my %distance_hash;
my %d_hash;

while($line = <PDB>){
 	if ($line =~ /^ATOM\s+[0-9]+\s+CA\s/){
 		my @splitter = split (/\s+/, $line);
 		$distance_hash{$splitter[5].$splitter[4]} = [$splitter[6], $splitter[7], $splitter[8]];
 	#	print $splitter[6]."\t".$splitter[7]."\t".$splitter[8]."\n";
 		
 	}
			}
close PDB; 	

#in 1Ru7 numeration
my @bg = (187,193,189,193,646,256,256,227,219,208,286,196,210,138,193,160,189,73,193,211,225,208,0,169,255,78,78,208,256,298,142,142,89,0,138,0,138,89,210,210,194,60,261,60,194,298,138,73,186,298,138,589,160,160,546,225,39,186,212,149,39,149,194,136,149,39,39,144,60,194,208,645,645,645,645,645,157,645,157,157,645,645,645,157,157,157,157,157,157,149,39,212,149,169,518,208,138,144,77,646,589,313,77,77,77,77,77,77,77,77,149,39,169,169,156,270,225,58,575,131,0,0,136,39,169,169,0,646,646,144,144,186,149,0,0,144,591,86,149,129,0,160,276,144,61,61,165,0,0,61,165,51,255,194,47,84,169,575,131,169,197,160,58,0,160,39,144,89,0,646,555,555,186,313,646,165,555,165,255,144,255,165,165,165,165,165,165,165,165,196,149,98,208,0,210,192,75,274,136,136,61,192,129,0,0,192,192,192,192,192,192,192,192,277,149,280,518,264,198,264,172,264,0,264,152,86,256,298,264,264,633,133,264,65,197,210,277,0,210,169,73,255,208,208,208,255,156,193,156,169,277,277,144,138,193,160,0,61,186,276,196,210,165,58,280,589,131,280,646,138,132,575,280,575,131,131,58,277,58,575,132,160,192,169,298,160,189,0,166,129,125,51,210,227,277,277,225,160,51,624,276,0,89,0,0,212,646,225,129,129,149,270,0,78,298,255,0,193,210,298,186,298,100,73,219,100,225,555,160,78,227,227,136,186,186,227,125,575,131,125,58,125,160,138,210,192,189,210,277,196,78,197,89,197,0,0,89,0,0,0,242,136,276,212,194,0,143,149,255,194,158,627,225,58,225,225,575,131,131,219,149,244,0,158,230,142,0,212,0,58,219,575,219,186,171,171,230,627,244,0,225,210,186,572,627,84,84,627,230,192,572,230,194,194,212,194,212,0,196,89,196,47,225,129,212,256,129,270,132,136,212,132,212,225,84,47,77,149,194,270,313,77,0,194,0,0,166,208,166,270,624,627,230,270,627,230,186,60,212,194,256,270,256,256,264,75,86,192,264,518,0,194,89,186,189,193,192,73,192,193,212,270,274,270,75,173,193,86,125,189,196,225,47,84,173,518,518,78,196,276,280,86,125,192,60,194,208,86,60,60,78,192,276,78,100,194,194,194,86,138,51,51,0,189,192,192,270,298,589,51,73,0,156,189,192,627,0,0,189,0,0,125,230,0,0,0,589,169,313,78,156,0,61,73,73,86,86,89,132,208,270,518,194,589,589,192,156,518,75,274,142,149,227,132,589,158,132,132,225,225,132,132,132,192,210,646,75,132,192,589,75,138,149,149,280,77,158,98,142,142,149,149,0,169,171,138,149,149,572,77,138,149,149,156,244,84,131,149,589,73,298,58,132,575,73,138,86,98,132,0,136,171,89,125,78,142,624,0,156,156,125,160,98,98,136,136,138,219,197,589,197,313,197,276,518,0,98,280,165,189,646,149,189,276,298,78,225,0,208,227,589,208,77,89,192,210,0,98,192,256,0,136,225,75,149,149,78,166,136,192,192,225,132,192,0,98,98,138,61,129,75,84,165,160,165,165,156,518,142,624,227,255,624,77,210,624,624,624,624,194,624,73,0,89,138,624,0,169,98,100,624,84,100,100,142,84,100,100,100,100,194,219,276,98,100,225,276,47,100,173,125,136,196,276,256,256,60,61,125,186,280,298,298,61,194,280,78,160,173,98,142,210,0,0,194,225,98,138,194,89,0,136,197,225,0,219,149,156,0,186,89,125,138,78,160,169,276,313,313,78,313,624,210,227,0,61,169,171,158,171,149,274,158,158,208,75,0,0,84,171,171,227,60,0,0,158,158,158,169,169,171,171,171,572,572,84,84,0,0,84,84,158,194,244,572,572,572,47,0,84,84,158,171,171,244,244,244,572,572,572,0,84,84,158,100,244,244,244,244,572,276,276,0,0,194,244,89,89,89,169,196,84,165,142,138,194,208,194,196,313,160,98,193,313,169,196,276,169,61,196,210,256,75,78,276,192,75,78,276,60,61,98,627,208,230,192,77,194,210,142,131,61,575,169,142,77,256,58,0,219,298,0,255,84,160,169,219,0,186,230,138,186,192,230,313,627,627,0,165,138,230,256,280,627,0,0,0,160,75,0,0,138,274,298,78,78,0,166,166,100,210,0,158,166,171,100,210,0,0,0,0,166,166,166,210,0,84,166,244,572,125,166,166,125,0,192,0,192,280,0,131,276,298,132,142,575,0,58,0,0,192,0,89,646,160,189,225,165,208,646,60,160,160,171,227,280,0,171,142,149,60,78,89,171,138,313,646,194,77,646,78,132,138,194,186,78,192,73,165,186,194,575,61,58,131,0,169,194,313,0,98,100,186,0,129,132,136,186,189,196,255,0,227,125,196,73,0,125,646,84,196,646,47,84,173,173,125,142,193,196,646,173,125,125,186,192,196,196,255,0,47,173,173,173,125,194,196,196,227,255,47,89,173,125,194,196,78,84,84,84,173,173,149,186,225,276,125,125,136,197,78,78,0,165,142,186,196,210,225,0,158,171,131,212,313,158,166,298,575,0,58,78,0,89,171,255,518,169,256,256,0,75,0,132,132,84,225,572,572,78,78,98,210,132,138,138,244,244,276,89,194,219,84,255,138,186,255,298,518,646,84,202,646,0,47,84,84,98,255,318,47,0,160,160,186,61,84,0,169,129,311,571,627,186,75,0,98,575,75,84,89,196,230,75,0,169,160,131,142,276,280,58,142,276,0,125,219,276,129,142,189,0,212,166,192,192,210,225,169,192,624,60,73,189,194,210,47,84,98,298,624,189,210,149,194,194,219,255,158,189,192,192,193,194,194,194,197,255,131,575,624,0,171,196,210,225,270,0,84,125,205,324,324,75,84,165,165,173,136,244,274,572,75,0,149,205,58,75,90,194,230,274,575,627,75,160,165,169,131,149,225,227,274,78,0,90,125,136,138,138,58,0,142,156,194,518,61,73,75,142,60,75,84,86,136,149,156,194,311,75,160,133,186,276,0,225,47,65,65,65,65,75,160,172,172,133,133,133,133,133,194,198,225,589,646,61,65,77,78,84,89,169,172,172,143,192,198,198,198,0,60,77,0,0,160,172,125,152,152,194,242,589,633,633,0,0,65,78,172,129,142,152,152,152,256,276,633,0,0,0,84,166,166,138,194,198,198,633,633,0,84,152,194,0,78,89,142,194,196,230,256,270,627,633,0,0,0,0,142,575,0,131,142,227,58,39,89,89,160,196,225,230,274,274,575,575,627,58,58,0,89,173,173,131,142,194,575,165,131,270,575,75,75,98,212,0,58,131,131,138,189,276,0,58,173,186,194,157,145,186,192,194,255,256,276,0,225,225,61,84,193,227,0,61,0,0,136,208,0,129,194,197,197,0,84,169,98,194,256,280,61,0,165,132,197,276,646,89,89,136,136,274,136,156,196,75,132,589,0,189,197,276,0,73,270,89,136,210,212,73,0,196,225,186,192,192,518,77,84,84,89,196,627,73,78,98,136,145,230,84,165,165,136,136,210,256,276,78,0,166,100,144,186,192,193,210,230,255,627,0,78,194,196,208,210,219,73,0,0,89,142,192,276,313,0,73,77,78,98,210,256,276,0,78,0,100,192,270,313,0,0,0,160,192,256,270,149,270,0,47,73,84,129,131,136,142,145,298,627,125,129,131,138,58,58,60,77,78,89,136,193,194,230,575,0,0,0,160,169,125,138,194,225,575,575,646,73,73,160,165,131,138,210,0,58,173,173,196,210,0,84,89,89,160,160,136,142,208,84,165,196,197,248,274,60,89,89,100,100,138,186,73,0,165,100,196,98,138,189,210,227,227,227,248,270,61,86,165,171,194,210,225,227,248,248,248,276,75,84,132,227,589,157,248,248,0,158,142,225,227,645,61,0,169,189,196,277,0,89,136,189,196,196,227,73,73,84,84,138,189,189,276,160,210,212,244,61,77,78,0,0,129,208,255,518,572,73,160,129,129,149,189,189,197,219,298,313,78,0,47,186,61,75,0,125,129,189,212,0,0,0,160,129,189,189,210,0,0,160,131,149,208,575,58,75,124,125,129,218,645,0,131,131,156,298,518,575,575,60,0,169,189,225,276,555,589,645,58,58,84,157,98,136,192,627,157,157,210,210,77,160,138,189,197,230,645,61,0,86,169,131,186,208,210,280,575,61,61,78,0,47,225,646,58,0,98,131,208,518,575,591,58,98,149,627,75,160,173,646,100,276,73,194,230,270,591,627,171,142,192,210,230,276,627,84,98,129,142,518,518,47,61,84,158,230,298,627,47,0,160,160,100,136,142,230,244,276,518,160,165,98,100,136,138,196,196,77,142,142,212,555,555,572,61,84,158,125,193,197,298,78,0,171,98,138,208,255,276,518,61,0,138,84,0,197,244,555,78,129,192,193,197,208,546,78,78,78,0,0,160,124,125,212,572,86,165,131,138,186,212,227,255,298,518,575,58,75,0,194,196,0,124,194,276,280,280,78,0,129,276,313,313,518,546,47,61,75,0,165,129,138,142,212,256,51,78,124,125,194,194,219,219,225,276,298,61,61,100,138,196,219,219,256,276,276,78,0,136,138,219,276,78,194,212,274,274,51,73,0,0,0,125,136,189,219,274,276,276,51,61,0,100,100,192,196,256,276,575,47,73,0,158,171,173,131,149,194,208,256,270,274,274,276,276,58,61,0,84,98,100,125,186,196,197,212,225,274,589,646,51,84,0,0,225,256,518,572,0,51,78,84,0,0,39,158,158,144,194,197,208,219,276,276,75,77,78,78,0,0,171,171,132,208,270,274,518,572,575,51,51,75,0,89,131,194,276,572,78,84,39,89,132,227,244,575,627,58,58,84,0,84,165,166,131,131,225,227,244,75,0,131,138,196,276,276,298,75,84,156,186,230,264,264,298,575,58,58,0,129,136,194,78,142,156,197,280,575,0,100,125,138,142,196,244,73,75,169,100,136,197,274,627,73,0,0,0,0,138,189,230,270,276,280,39,0,0,138,192,193,197,225,89,186,212,78,129,186,197,270,280,0,0,0,131,131,192,575,589,78,0,129,131,646,58,84,0,165,169,98,129,131,142,255,575,575,575,58,58,61,136,156,196,196,256,256,313,589,58,100,129,132,136,47,78,0,0,0,47,89,169,192,313,627,0,156,189,313,589,0,84,86,156,210,230,298,298,627,78,84,0,158,169,131,193,230,274,298,60,0,39,192,208,58,84,138,138,142,208,227,575,624,0,84,138,208,244,270,313,518,572,589,78,0,89,136,210,270,276,313,73,0,171,156,212,212,225,227,255,274,276,313,156,194,194,264,280,311,313,518,555,575,75,171,196,219,227,589,646,51,58,73,77,0,40,84,158,131,210,244,298,313,142,73,84,84,40,84,158,160,193,194,196,244,256,270,313,555,575,75,75,77,78,0,0,39,166,189,197,212,572,572,575,575,589,58,58,84,0,160,160,169,131,131,227,276,313,58,129,131,188,192,196,255,256,274,0,100,142,192,225,646,75,100,142,186,188,276,313,0,166,131,189,77,0,89,160,100,100,138,188,192,210,313,575,60,89,156,192,264,58,142,194,196,212,277,73,78,0,0,84,136,138,142,142,149,280,280,298,47,60,0,158,171,142,193,212,264,0,158,158,145,208,208,298,313,572,0,138,208,210,255,255,572,47,47,75,84,171,171,156,192,193,208,518,518,589,75,0,160,98,129,227,244,264,518,572,0,158,171,197,208,244,518,125,186,189,219,244,270,277,132,149,189,244,572,47,61,193,298,518,51,84,84,169,136,270,280,518,47,47,0,0,0,0,0,84,84,129,225,227,518,518,47,166,196,227,0,73,0,166,138,142,142,196,210,210,219,256,518,518,518,0,51,73,77,0,84,89,173,142,156,186,186,276,276,589,0,0,136,142,142,189,39,75,77,165,125,125,280,47,60,61,77,39,84,89,89,166,142,196,274,589,646,47,89,196,280,298,518,0,84,0,169,0,47,60,0,196,256,298,589,39,78,84,0,100,136,149,186,208,277,298,298,0,0,61,89,89,171,171,132,132,189,192,589,73,84,0,47,86,169,98,100,129,142,149,189,227,230,256,572,627,0,40,86,158,160,100,125,136,189,208,298,0,60,0,0,0,0,0,0,160,165,129,136,244,0,0,158,100,125,136,189,192,192,196,61,78,0,0,89,89,129,47,61,75,197,0,0,0,0,89,169,171,192,194,196,197,205,219,219,270,274,276,324,0,84,84,129,142,186,189,192,193,208,277,572,589,0,0,89,100,100,129,192,192,194,210,255,274,518,75,0,84,89,166,90,100,125,131,197,244,0,169,100,156,210,589,58,73,78,0,0,40,84,86,208,210,227,227,227,270,575,591,47,0,89,166,125,189,210,225,0,84,84,158,165,173,129,142,208,230,276,280,298,627,0,0,0,129,225,313,0,60,73,0,0,84,160,100,129,131,196,270,572,575,627,78,0,89,165,131,192,210,58,75,0,0,86,160,131,132,197,208,210,210,230,575,575,646,58,58,0,0,0,160,169,193,208,210,0,173,194,219,280,0,58,75,171,125,125,136,194,196,575,0,89,129,142,186,189,210,219,225,270,39,78,89,166,131,142,244,575,58,77,86,160,131,149,157,208,227,298,313,73,0,0,160,98,194,208,280,646,98,100,276,280,313,75,160,166,142,208,210,227,60,0,160,171,171,131,210,225,0,75,0,0,158,158,160,129,156,627,51,58,75,77,0,0,89,160,100,129,129,208,277,298,575,575,646,73,78,0,165,125,208,210,210,227,230,256,572,572,627,47,73,0,165,169,100,131,186,189,196,208,244,270,627,61,73,160,136,219,255,264,518,58,60,61,75,169,171,131,192,230,244,298,518,575,58,60,77,84,149,149,149,255,270,75,0,160,166,171,125,129,132,138,210,227,274,277,572,0,47,158,165,100,136,156,196,210,230,255,277,298,75,84,84,169,124,136,193,194,51,160,98,208,219,256,298,518,78,158,169,98,125,186,280,298,298,313,0,160,169,125,138,194,208,219,244,298,646,0,0,0,166,169,98,156,212,230,255,274,572,591,138,149,189,193,244,0,160,98,145,208,227,274,280,280,627,627,51,0,84,86,89,160,166,100,210,256,280,575,75,75,98,100,131,132,138,192,225,230,256,276,298,298,575,60,60,60,75,78,0,173,98,100,136,186,186,192,196,197,227,274,274,298,0,0,165,173,131,138,189,219,276,313,47,58,0,89,165,194,212,274,274,274,276,627,60,75,78,86,196,212,230,518,75,0,160,100,132,136,194,196,212,270,274,518,58,73,75,0,173,125,142,186,193,194,230,75,0,98,149,192,194,194,196,212,280,298,60,75,0,0,0,169,171,227,227,277,298,538,627,61,0,144,274,0,78,189,192,192,197,252,255,298,538,158,156,189,210,212,256,313,0,0,47,86,158,138,149,193,208,210,210,227,227,572,75,78,0,89,157,171,125,197,274,274,61,61,61,0,157,158,171,171,125,132,196,196,196,196,197,230,244,244,627,645,73,73,75,165,131,142,157,298,575,645,645,138,196,197,197,227,230,270,572,575,645,646,47,61,61,157,158,125,193,196,274,627,627,0,61,0,0,86,166,131,131,144,149,149,197,244,572,0,58,60,0,0,125,131,138,142,186,196,518,575,58,58,0,0,0,89,171,149,186,194,196,219,276,572,575,575,589,60,61,61,75,0,0,89,160,189,194,518,627,77,0,158,158,165,171,171,132,136,196,197,205,230,280,313,575,591,60,73,0,0,0,125,131,131,131,131,149,186,189,212,244,244,244,572,58,160,166,171,171,98,142,186,189,193,196,197,230,244,298,324,324,572,575,575,0,58,171,131,132,132,205,219,276,572,0,47,58,158,158,129,186,186,196,210,219,244,572,575,58,58,61,0,0,86,89,169,171,90,149,256,280,518,589,627,627,47,58,61,0,86,90,125,131,133,192,212,230,230,276,575,58,58,75,77,84,172,98,129,131,133,198,208,219,225,255,256,518,0,0,0,0,186,198,212,244,572,589,591,627,0,61,65,84,0,84,172,98,129,131,132,152,156,197,210,212,274,575,633,0,65,78,173,129,132,136,156,192,197,208,219,219,227,280,575,589,0,61,78,0,0,98,98,152,197,208,210,575,61,78,0,89,165,173,100,131,138,142,196,208,589,633,0,58,61,0,0,160,165,166,171,100,210,58,60,0,0,0,86,165,173,131,227,255,313,313,575,58,78,0,173,131,132,136,192,197,0,0,58,58,160,165,98,129,144,156,186,230,575,627,0,47,60,75,78,89,166,131,132,230,60,0,89,171,125,131,136,189,208,210,280,280,575,575,0,0,60,73,78,78,0,89,166,129,60,0,158,169,100,125,129,197,208,256,274,276,313,58,0,160,125,189,298,78,0,0,0,86,165,132,194,196,227,256,270,280,158,100,100,142,197,210,219,230,256,280,298,627,627,646,47,73,78,78,0,125,129,136,142,149,189,192,212,225,244,280,298,572,627,627,0,0,0,142,230,230,276,280,627,0,0,0,84,84,86,160,171,173,138,144,196,230,230,298,589,78,78,0,0,86,89,129,138,210,227,274,518,627,171,173,125,518,589,60,0,0,160,193,193,194,244,47,78,0,84,165,149,156,230,230,244,276,280,280,298,589,627,165,129,196,208,225,227,274,0,0,131,136,136,138,142,193,219,227,227,280,298,589,47,58,75,77,78,78,160,149,186,192,196,227,575,646,61,77,100,132,136,192,255,313,77,165,98,100,125,156,194,197,208,219,225,227,274,572,100,131,136,280,575,75,0,0,47,84,158,171,171,196,208,210,646,60,75,0,158,158,166,136,227,227,572,75,75,165,171,100,193,193,193,280,58,0,186,193,230,274,627,169,189,219,227,244,244,244,256,546,572,75,0,166,169,100,270,572,0,158,165,171,100,129,132,136,219,244,276,298,627,646,0,60,61,160,169,100,131,270,61,73,100,125,208,212,227,230,255,274,276,280,572,575,47,47,58,0,0,165,125,129,208,219,225,298,575,0,47,58,75,0,0,0,165,171,98,125,145,156,208,219,227,230,255,256,589,627,627,60,77,165,125,131,149,189,227,298,589,0,89,158,165,125,125,138,156,208,624,627,173,173,125,125,131,138,142,196,270,627,73,166,100,230,270,77,0,0,192,192,194,196,196,208,208,230,230,572,575,575,51,0,0,89,98,131,145,208,225,58,61,73,0,166,166,166,142,189,208,208,270,627,627,100,100,125,138,189,194,197,219,227,230,230,313,313,627,627,627,58,60,60,131,138,193,196,212,230,230,256,298,518,645,60,60,73,166,169,138,196,196,212,230,47,58,60,60,169,100,136,193,196,208,208,274,518,575,47,75,98,132,138,208,208,298,313,51,60,100,131,197,212,280,518,543,575,627,58,61,75,77,77,98,124,131,194,208,298,60,77,0,157,166,169,100,144,197,210,219,298,575,589,627,646,0,58,61,0,0,98,100,138,208,227,230,274,298,298,298,624,0,47,61,75,165,98,100,129,138,186,196,208,264,298,555,47,173,129,194,212,225,256,313,313,555,589,60,77,0,166,169,136,149,186,196,230,230,298,77,78,0,0,89,165,100,100,125,186,298,624,627,60,75,0,160,165,129,129,131,132,189,193,230,274,276,280,280,60,60,0,0,0,0,0,158,166,171,173,129,142,144,194,256,264,270,518,646,60,73,0,0,86,166,129,197,219,270,276,280,298,313,627,0,0,0,0,166,132,138,144,225,270,274,575,0,0,61,61,73,125,129,138,138,142,189,196,244,255,264,274,298,572,58,61,78,0,84,89,129,138,138,156,194,225,264,298,47,0,158,173,98,129,142,189,197,210,227,280,298,589,0,78,173,100,125,129,142,142,149,298,34,0,0,171,138,196,248,256,256,276,589,646,34,78,0,40,169,186,194,219,227,255,276,280,572,84,100,129,129,142,156,189,197,244,256,274,518,0,47,78,100,142,256,280,624,627,0,0,0,0,160,165,100,192,205,208,227,230,274,324,591,73,75,0,0,89,165,165,100,125,129,138,193,210,324,589,78,0,89,158,165,129,129,189,192,205,274,646,0,73,73,77,47,165,165,142,189,192,646,61,78,158,165,100,132,186,198,210,227,627,0,51,60,65,65,0,0,90,90,129,133,133,152,189,198,227,255,256,313,627,646,160,165,171,133,142,149,227,230,518,572,627,65,0,0,89,172,172,136,198,208,219,225,225,225,230,0,0,73,165,171,172,138,152,152,192,244,244,270,572,633,633,0,100,125,142,142,192,219,230,518,627,47,0,165,165,169,142,197,210,225,298,575,627,633,47,125,208,208,219,225,230,0,0,40,100,131,136,219,219,230,255,255,274,280,575,627,58,0,84,158,166,171,100,131,230,572,77,0,158,160,125,125,196,210,219,255,272,280,73,77,0,165,166,166,142,193,193,193,208,208,219,572,624,0,39,58,73,84,89,160,165,100,129,142,142,186,646,39,60,61,0,39,158,138,189,219,219,244,274,0,40,171,136,144,196,219,75,0,0,158,160,169,171,196,225,591,60,73,0,100,156,192,227,230,244,298,591,627,75,77,158,171,171,173,100,100,193,227,244,298,572,572,39,0,0,89,89,173,98,98,98,100,298,298,298,39,60,165,166,166,169,100,100,131,142,192,210,244,298,646,77,39,86,158,171,98,193,230,256,280,575,0,60,0,39,84,89,173,100,100,136,225,244,274,572,591,58,86,125,129,210,219,255,274,627,60,75,75,86,86,158,173,136,230,244,572,627,47,77,0,0,0,186,189,210,219,270,274,276,84,0,0,0,86,89,160,171,173,173,98,100,210,276,280,313,75,158,166,173,138,156,255,256,47,77,0,0,160,166,98,132,156,193,244,555,572,0,0,84,129,197,208,225,280,165,166,171,129,138,189,210,225,274,34,47,0,0,0,89,160,171,129,197,219,225,227,230,518,627,47,51,77,0,0,39,160,131,188,230,518,627,627,627,61,75,0,86,158,171,98,125,189,225,227,227,230,274,572,51,58,73,0,0,98,124,156,244,274,280,324,575,627,627,0,40,84,158,131,186,230,230,256,270,298,324,572,627,47,0,0,0,158,192,205,244,280,280,60,0,0,86,158,160,171,100,197,197,205,210,230,230,270,280,546,575,627,627,0,86,88,165,166,171,129,132,133,225,227,277,280,627,627,58,60,65,77,171,173,90,98,129,132,230,256,270,277,280,572,572,572,627,39,172,173,90,152,219,230,230,244,244,277,0,0,158,165,165,125,138,143,198,227,244,256,0,75,0,0,158,166,124,125,129,132,242,280,646,51,0,0,160,136,227,230,230,277,646,0,0,173,138,142,189,219,225,633,86,100,125,131,131,197,518,546,572,575,0,0,158,173,142,142,197,225,227,227,244,244,256,276,280,47,58,0,0,86,173,173,131,156,196,197,277,280,280,313,624,58,0,171,98,189,256,280,280,555,555,572,572,575,60,75,77,158,158,171,138,280,280,572,575,58,61,75,0,0,0,158,158,131,136,193,208,212,227,244,274,276,572,47,60,0,0,0,158,98,100,125,131,227,244,244,277,313,572,575,0,189,255,280,575,34,58,60,60,173,192,219,227,256,313,313,627,58,0,158,131,189,193,197,227,230,230,276,555,572,645,0,171,100,156,189,219,227,244,286,555,575,47,75,0,47,84,84,89,165,157,192,197,225,227,244,274,276,572,627,627,58,77,47,157,135,149,196,197,219,276,280,298,313,572,84,0,0,227,230,518,100,124,124,125,132,142,197,208,219,227,244,518,645,646,51,73,75,84,0,166,100,125,132,149,197,219,225,230,244,276,543,589,627,51,75,0,0,165,149,192,219,227,75,0,125,189,192,197,197,60,61,0,189,193,208,230,627,60,61,73,78,0,0,129,142,142,192,197,280,60,72,73,165,125,142,142,274,274,47,47,51,61,73,0,100,149,189,192,193,255,276,277,298,518,61,0,158,165,189,197,627,60,165,100,125,192,197,256,274,274,518,518,0,60,0,158,171,171,100,100,132,189,189,230,248,280,60,60,60,77,0,158,158,100,133,156,227,248,248,276,277,298,0,60,60,65,77,0,0,165,166,173,192,193,197,276,572,84,98,125,189,192,198,208,208,244,0,0,158,171,172,100,197,208,244,276,166,171,100,129,152,196,225,227,248,274,280,572,572,572,646,646,0,0,0,0,166,173,125,132,208,219,244,244,276,633,75,77,78,0,158,173,100,100,244,572,60,60,0,0,0,158,171,173,125,149,193,572,572,75,0,0,158,165,100,256,51,0,196,219,244,256,256,298,298,313,60,73,78,171,100,132,189,197,208,244,255,298,572,624,60,0,0,158,165,165,194,194,227,244,244,255,280,298,313,646,47,280,280,646,60,89,171,192,77,165,166,210,227,572,77,0,125,227,280,313,627,646,47,61,0,165,166,100,227,298,61,0,165,171,193,274,274);
my @fg = (217,217,217,145,311,318,571,208,208,219,196,286,138,210,286,210,286,34,211,193,208,225,311,311,311,89,0,256,208,208,89,0,142,142,0,138,89,138,0,89,261,261,60,298,298,194,261,186,73,138,298,212,0,89,538,34,0,169,149,212,272,0,169,34,272,145,217,0,208,208,194,143,242,633,133,198,172,65,0,152,172,0,152,143,242,633,133,198,65,217,252,591,145,518,169,138,208,272,152,589,646,34,143,242,633,133,198,65,172,0,252,286,589,156,169,591,186,160,160,160,205,324,186,0,0,202,90,202,0,217,145,311,286,136,589,72,86,591,0,160,160,0,34,252,205,324,261,202,0,90,298,0,589,311,136,136,571,210,210,318,160,197,210,160,0,211,286,0,0,571,205,324,313,186,318,152,90,227,0,0,202,143,65,172,0,242,633,133,198,160,211,591,129,210,0,242,136,136,274,75,0,0,210,318,571,65,633,133,198,172,152,143,248,0,0,129,311,198,264,172,264,0,264,152,264,72,298,256,633,133,264,264,65,264,210,197,272,210,0,73,169,571,58,575,131,318,193,156,311,88,145,217,211,0,160,193,61,0,276,186,210,196,208,280,58,591,280,131,88,47,298,280,575,89,0,89,0,252,89,0,261,192,160,212,129,189,160,88,645,125,129,538,0,129,286,0,160,225,624,51,0,89,0,0,0,646,212,255,89,0,270,149,78,0,58,88,212,210,193,575,589,131,230,311,129,627,555,225,0,0,575,131,169,202,0,58,575,125,125,131,125,58,138,160,192,210,210,189,211,78,196,89,197,0,197,89,0,0,0,242,0,276,136,0,543,143,0,538,212,589,627,158,58,225,131,575,225,225,219,131,0,230,230,230,158,0,142,272,34,219,58,219,575,318,230,627,171,171,627,627,210,225,571,627,572,627,230,84,84,72,230,572,202,255,217,0,145,196,0,196,89,543,129,225,252,129,256,0,208,311,286,227,0,218,34,34,230,591,318,272,169,627,230,571,186,627,230,47,627,145,248,298,261,217,261,298,88,129,211,129,58,252,575,131,143,194,0,78,242,589,136,280,136,212,78,89,51,88,0,0,72,286,34,0,34,230,188,272,627,0,627,169,186,186,627,202,0,210,230,538,47,145,230,272,131,88,160,217,58,575,298,145,0,261,165,58,131,575,252,129,90,324,65,89,89,217,211,47,0,205,589,633,589,0,0,208,133,172,188,152,0,208,208,143,198,242,272,591,311,47,202,0,136,202,0,286,0,0,165,210,72,571,212,145,217,252,0,318,186,186,210,72,47,633,252,543,65,172,0,89,152,0,133,0,136,135,261,198,286,286,298,58,65,133,160,274,165,0,261,298,633,0,165,255,165,575,152,172,165,227,131,143,242,286,165,165,0,198,0,318,160,0,627,0,571,555,211,280,230,255,589,219,255,78,208,47,0,591,318,571,47,136,145,272,202,0,136,47,90,211,324,135,205,169,88,169,217,210,129,230,591,90,627,88,210,194,311,538,0,160,72,89,165,538,230,0,255,252,627,261,165,571,47,0,205,324,136,165,318,75,211,543,274,156,0,286,0,218,255,0,208,194,575,0,131,58,88,212,208,133,210,591,152,0,255,65,198,242,0,186,633,212,34,34,0,143,311,135,298,143,172,169,65,152,194,645,133,172,242,633,144,160,627,261,198,61,230,169,0,165,165,88,165,555,47,313,47,270,160,591,89,0,89,538,47,0,0,255,219,211,136,538,131,575,40,0,72,255,0,186,58,212,0,280,0,210,624,212,0,255,0,210,61,255,538,0,311,589,0,555,202,538,34,89,135,34,272,143,133,65,248,169,198,0,555,169,198,633,152,242,0,0,160,133,172,143,172,242,145,217,133,152,172,65,152,65,143,65,152,172,198,65,256,65,143,172,633,311,0,311,633,633,198,633,152,172,0,133,242,0,205,133,242,152,227,143,198,242,633,198,194,218,324,90,160,133,90,205,324,252,58,0,645,0,538,591,543,0,575,318,34,208,0,571,286,131,205,0,188,0,186,160,0,218,90,227,47,538,324,210,186,546,129,218,129,0,264,210,0,255,136,0,136,211,555,157,142,136,589,89,555,0,135,0,186,72,0,0,144,58,280,135,188,575,88,58,131,143,47,34,131,210,555,575,145,202,152,0,311,133,172,543,311,543,34,138,272,152,242,261,90,65,227,0,227,298,324,227,198,242,0,65,143,633,205,633,227,133,227,227,0,172,198,89,252,280,217,264,543,169,0,645,218,129,218,0,571,0,0,318,165,286,169,0,90,165,0,219,0,145,89,205,324,324,555,218,188,90,538,188,0,186,188,205,186,212,272,89,73,217,129,73,0,0,0,0,86,591,160,272,124,255,124,255,255,0,277,277,144,211,193,208,217,136,136,78,591,145,156,633,0,88,543,242,188,255,72,198,252,589,65,286,589,0,65,172,0,138,0,0,0,143,65,133,252,0,143,152,145,311,202,198,242,633,152,135,133,242,218,272,0,311,133,172,313,198,58,202,572,0,152,0,51,286,589,165,143,633,255,72,131,575,227,210,34,0,172,169,0,212,261,261,538,193,646,298,227,0,538,0,538,324,298,0,298,217,591,0,0,89,270,543,261,131,575,261,202,261,298,90,205,0,188,58,205,324,261,298,0,270,125,555,298,0,90,211,286,227,255,211,318,0,72,202,318,158,571,73,252,571,571,47,78,169,166,169,47,0,144,0,158,318,47,72,129,89,34,34,255,255,0,0,47,555,84,572,188,34,129,270,0,34,186,0,277,555,543,173,255,0,58,255,73,0,58,131,311,318,40,575,90,555,144,131,272,61,88,88,156,280,205,575,0,546,73,555,218,72,208,0,0,193,135,145,270,0,136,211,186,186,324,208,208,227,270,571,193,129,208,227,90,90,205,0,166,0,89,227,144,208,589,208,218,136,86,324,186,589,324,217,160,0,0,160,280,311,518,158,0,77,538,0,202,543,142,205,543,135,194,197,0,645,58,591,252,144,311,135,58,131,543,202,98,193,73,193,255,0,543,575,61,172,277,589,124,144,212,133,172,198,0,131,0,65,152,65,152,198,633,0,286,65,88,193,277,0,152,298,188,212,124,313,133,633,242,149,152,172,633,133,218,261,144,298,270,0,218,133,633,0,143,270,65,0,65,589,633,169,198,538,575,65,172,0,194,0,152,172,198,538,543,261,298,188,218,133,0,133,172,633,518,198,276,152,280,589,90,546,47,210,277,212,210,198,202,0,124,261,205,205,546,90,324,219,205,156,202,0,144,84,197,627,318,571,58,324,230,90,324,194,546,205,324,324,78,166,90,248,205,188,131,318,571,40,156,538,575,58,575,169,135,202,252,131,90,0,72,645,135,124,197,211,277,555,313,0,0,0,555,274,124,280,318,89,40,219,0,136,255,34,193,255,0,571,555,543,212,0,78,208,0,34,157,242,51,624,144,318,571,145,272,88,217,144,129,88,143,73,555,145,270,124,277,0,73,555,252,124,0,145,591,142,188,572,0,244,135,208,75,248,277,136,89,272,61,0,0,0,0,218,51,555,194,286,589,543,318,311,88,208,645,86,40,157,0,546,89,144,0,591,0,188,645,0,0,0,217,255,208,88,543,645,188,255,171,252,518,270,39,202,218,571,270,197,186,129,144,324,591,158,0,555,124,219,40,90,156,205,218,129,0,256,0,169,211,188,0,136,165,298,186,78,0,78,169,0,645,160,218,166,86,60,165,78,313,47,84,589,256,261,311,0,212,169,188,40,194,286,0,543,188,0,318,212,188,261,298,298,571,61,280,47,84,202,546,72,280,255,144,60,261,538,152,212,227,61,212,58,575,270,158,166,51,194,131,194,129,144,124,555,133,172,198,172,156,546,212,218,100,227,277,40,633,65,198,633,546,212,100,47,65,156,518,133,0,538,100,169,270,0,518,589,39,546,172,0,156,100,39,98,198,219,255,152,72,211,149,264,78,133,143,255,571,88,86,100,202,248,627,138,218,205,0,40,277,100,98,318,90,575,274,65,242,188,280,0,136,230,131,0,645,0,144,90,0,324,0,280,144,205,324,555,58,152,633,218,58,575,277,311,39,538,311,311,256,645,0,131,34,0,543,61,0,135,255,145,61,0,280,75,193,0,124,277,34,0,227,61,0,77,248,144,277,0,555,227,0,47,84,219,88,219,0,34,555,248,277,135,73,270,270,543,40,212,136,270,318,571,124,34,40,0,158,270,73,86,144,34,0,144,72,144,188,124,543,40,218,208,313,219,144,277,572,543,0,248,60,645,61,173,39,194,572,194,40,58,543,0,217,272,591,88,591,645,60,0,218,255,645,47,84,0,0,311,218,645,219,0,212,274,575,78,124,40,208,555,132,197,270,40,543,0,645,171,0,129,645,197,0,538,546,129,129,131,256,186,158,274,252,218,256,60,129,0,144,129,129,589,188,518,72,186,0,0,202,256,0,0,188,39,90,219,144,129,156,0,0,124,256,187,136,313,40,166,0,0,0,78,192,51,272,324,0,143,255,0,75,145,78,152,73,277,286,0,555,47,160,186,0,169,227,160,188,144,172,165,205,84,156,197,133,198,277,172,34,84,173,47,142,538,172,0,0,198,0,142,217,572,546,633,242,277,158,135,172,633,198,124,252,169,149,264,40,227,65,152,171,633,65,39,171,0,157,624,138,125,212,124,144,0,0,58,58,171,124,192,173,324,227,197,133,198,65,133,124,212,58,244,555,518,142,546,218,248,244,324,0,280,543,633,51,546,286,90,138,211,131,591,152,318,125,518,51,280,131,575,156,149,124,90,152,98,166,98,100,0,571,193,131,131,575,219,205,86,65,72,58,589,133,0,0,194,51,546,142,158,575,88,142,193,591,160,255,575,546,0,546,589,131,575,575,280,100,589,0,205,0,131,210,100,202,589,75,61,142,186,627,58,145,193,0,157,165,0,0,202,0,166,144,158,645,40,627,0,58,0,202,144,160,194,0,230,156,58,572,230,149,248,39,131,0,227,40,72,211,90,205,277,47,227,280,149,538,34,324,149,202,40,136,575,546,149,0,0,219,0,270,86,124,40,98,61,518,318,571,47,318,40,144,311,311,555,256,318,135,0,77,125,218,61,277,124,543,277,555,571,555,571,197,645,272,34,646,135,280,145,144,277,210,270,210,313,135,84,270,572,173,73,173,192,84,272,78,270,0,84,0,187,72,277,0,217,51,78,205,324,280,39,73,274,219,0,88,144,280,255,90,136,219,187,98,78,88,219,88,571,546,188,0,88,197,248,124,318,169,219,144,0,186,219,188,212,144,144,543,591,40,0,0,39,277,78,252,77,248,276,40,256,591,39,194,166,136,274,645,34,88,217,248,270,218,591,0,0,136,538,135,193,61,218,158,88,188,129,192,0,218,149,0,219,252,256,313,0,0,543,173,78,51,255,189,186,78,546,187,286,171,47,0,89,129,60,78,0,188,129,142,78,624,0,78,84,212,244,47,212,78,158,142,591,646,47,84,51,227,166,84,0,212,90,129,149,188,88,144,135,0,75,546,313,546,165,51,589,173,324,75,98,73,124,39,129,51,73,135,149,89,264,125,205,124,173,72,39,255,73,72,142,227,39,277,0,171,88,280,645,98,0,248,145,256,39,165,0,280,0,186,188,145,0,124,0,0,202,0,274,248,0,47,518,187,61,144,78,211,0,47,84,311,144,193,546,518,217,0,277,0,47,518,211,136,187,0,65,242,0,124,157,173,47,124,34,0,518,124,47,144,157,157,169,270,518,198,100,149,645,255,47,135,193,264,197,136,157,157,272,51,51,169,152,0,252,272,280,546,244,90,633,194,0,156,157,40,572,169,157,217,546,39,186,133,143,252,58,100,0,0,543,149,131,212,40,144,518,73,135,0,0,0,172,0,272,0,276,575,145,0,0,100,0,277,125,192,51,543,86,165,546,193,88,571,298,135,125,58,264,51,75,324,166,0,149,131,244,286,145,272,575,318,205,248,77,270,286,217,324,205,144,40,217,0,192,276,286,98,40,543,90,627,311,248,72,125,39,248,555,0,219,0,0,187,61,0,252,0,591,252,0,248,270,0,89,194,194,624,256,72,589,72,144,98,75,274,589,219,187,261,225,136,230,248,136,158,72,280,248,135,84,138,270,196,280,270,194,538,125,202,277,0,98,173,73,136,277,218,248,160,39,160,77,136,555,255,261,298,572,144,227,61,166,194,286,0,211,225,135,0,211,166,264,72,166,187,160,277,538,274,61,219,0,40,0,135,518,219,555,211,270,202,39,646,219,255,40,124,188,160,88,645,0,72,60,543,555,135,274,98,0,270,73,572,73,210,160,211,173,219,194,0,138,311,160,98,188,218,186,272,274,138,193,51,571,270,248,624,40,546,145,90,205,324,624,138,197,277,318,98,219,280,40,217,125,171,193,546,210,255,645,88,84,589,0,197,188,0,0,124,313,88,571,0,124,197,34,546,280,311,210,145,149,318,51,158,77,210,51,255,149,77,171,0,142,0,252,0,142,0,645,187,0,0,88,0,0,286,0,255,0,142,73,51,142,218,0,75,272,244,538,202,194,256,129,34,538,78,274,591,60,210,255,518,173,75,144,591,543,75,218,60,280,0,166,51,136,248,0,591,274,0,149,212,210,149,149,78,188,252,591,589,77,277,188,124,0,0,646,0,0,160,39,318,144,156,88,171,256,169,40,0,217,78,98,571,98,274,0,264,194,51,264,173,72,591,624,270,51,39,51,264,286,84,124,0,219,173,39,0,47,84,624,166,572,39,47,197,135,546,173,197,149,555,173,256,40,0,0,171,211,78,0,165,51,264,40,124,218,89,0,0,158,197,98,555,248,88,51,88,538,135,270,72,149,34,73,0,313,197,186,73,193,264,89,156,555,40,264,589,158,156,156,194,47,0,135,157,165,192,274,145,0,98,518,0,171,212,555,0,274,144,145,244,89,212,0,89,538,0,192,40,169,75,538,156,72,202,546,89,0,86,173,125,646,196,171,171,274,84,225,136,0,276,0,0,77,0,149,187,61,277,571,572,124,211,248,40,51,624,39,0,0,318,125,572,193,546,47,624,627,0,192,138,149,0,0,51,149,244,208,173,89,40,274,197,124,212,169,98,311,0,34,138,270,546,188,135,40,75,157,75,624,255,270,135,272,0,230,142,135,645,225,208,219,34,98,261,88,197,73,90,205,324,166,225,157,575,210,280,0,156,188,77,98,546,248,272,0,0,98,280,34,58,73,193,51,186,47,39,572,135,0,572,138,90,0,166,194,286,298,0,219,217,193,244,543,75,0,264,188,624,624,244,0,646,51,173,197,173,217,645,73,173,0,270,131,0,125,244,34,219,186,252,218,135,73,39,205,324,264,270,0,212,188,286,555,277,158,274,555,61,0,0,84,277,186,145,555,193,252,219,135,138,138,218,277,0,125,39,0,555,572,218,78,546,0,158,274,518,39,624,274,173,61,0,189,40,572,270,311,555,72,73,187,158,274,197,248,589,72,211,272,0,0,77,264,77,77,274,572,218,61,166,276,0,555,324,274,555,205,274,149,192,227,0,0,227,51,125,0,51,264,0,0,202,0,0,205,219,274,145,219,0,158,166,194,219,84,274,39,270,277,90,324,645,98,188,589,0,248,145,272,280,0,173,171,77,77,313,145,144,149,194,538,217,591,149,0,77,543,272,272,0,84,543,244,645,84,645,264,78,311,324,591,84,217,0,192,78,217,252,211,173,202,313,40,538,646,256,219,160,0,149,218,186,149,218,543,280,280,173,270,90,124,645,286,0,169,125,218,138,197,158,194,252,286,0,277,194,75,124,84,149,543,218,217,572,160,60,543,189,51,86,624,186,256,88,219,218,189,171,270,149,194,252,543,0,194,166,60,194,171,188,40,194,197,645,252,60,194,138,77,624,0,158,205,194,543,166,166,194,72,274,88,77,543,142,173,270,40,60,546,274,0,142,188,313,286,286,60,39,171,0,98,227,538,189,142,188,248,98,72,98,78,210,60,227,624,51,72,248,227,51,90,193,0,0,193,149,51,149,571,248,248,51,60,60,75,40,169,227,624,248,132,125,313,248,0,142,211,51,248,276,218,645,277,264,72,248,256,227,145,0,149,248,187,313,125,39,142,144,274,124,277,211,197,248,75,272,192,318,165,270,227,571,591,142,171,211,0,84,256,205,78,0,171,189,173,0,149,546,227,86,211,274,125,142,158,324,210,124,136,313,129,61,244,47,39,248,90,518,129,546,646,256,543,129,171,0,40,0,274,142,188,196,318,225,276,75,274,645,188,89,0,187,158,274,169,75,144,193,256,0,192,166,276,51,75,518,144,270,227,225,188,0,624,518,646,173,543,589,0,274,624,173,188,311,0,217,286,156,193,264,173,0,173,171,166,624,34,156,47,156,166,124,280,193,624,75,313,77,149,51,252,624,248,591,88,144,84,61,124,277,538,192,0,572,255,0,591,84,256,78,0,646,88,149,61,75,98,193,646,72,192,264,186,591,244,225,0,34,34,39,227,171,202,142,171,311,0,171,0,197,0,75,311,208,197,270,572,646,0,171,196,51,543,572,47,135,188,624,61,270,591,124,189,624,0,0,274,0,197,73,276,589,40,546,256,158,157,157,0,189,138,86,158,256,58,90,187,158,189,171,77,197,78,144,645,0,256,572,264,318,571,173,51,0,169,189,157,196,135,0,0,51,0,40,0,264,192,193,205,248,0,202,39,156,277,546,40,0,89,211,274,276,518,142,189,546,88,40,280,40,144,40,100,624,0,98,546,0,132,124,0,98,196,138,212,73,169,73,197,518,158,166,572,86,84,572,197,75,212,0,189,0,0,142,277,135,0,187,124,84,142,75,142,89,77,318,571,0,149,173,192,75,538,248,324,575,189,572,280,518,131,124,572,124,75,0,0,39,0,75,142,34,218,142,572,280,0,0,256,0,75,248,280,61,280,138,135,256,248,61,280,84,196,546,188,277,546,572,0,197,34,0,75,219,280,132,144,145,196,84,546,187,39,77,212,280,158,218,225,0,274,73,0,256,73,0,0,149,135,0,192,270,158,189,187,135,192,311,244,187,205,188,256,272,270,125,277,280,0,39,202,589,277,555,270,188,158,98,171,189,73,98,244,192,244,0,90,324,98,543,217,219,277,248,270,166,173,645,145,135,202,546,0,187,555,0,589,646,149,188,125,171,186,244,197,244,166,252,202,0,244,313,645,546,196,225,125,277,313,40,98,142,313,158,188,518,144,149,274,73,186,125,0,189,0,88,125,186,189,166,518,518,219,311,264,0,571,218,555,197,318,571,645,256,589,543,0,624,125,173,88,197,186,145,270,157,0,88,518,77,189,624,88,589,125,318,173,543,197,202,124,90,156,78,0,72,286,158,192,543,192,274,543,144,272,171,211,0,270,555,0,205,276,149,98,225,173,129,256,39,256,645,158,84,543,194,219,256,264,624,272,318,218,244,165,218,51,324,248,138,125,124,0,276,149,125,624,646,276,313,98,145,192,173,0,75,212,39,313,98,166,217,157,40,149,276,313,124,60,188,98,286,0,39,274,77,252,124,274,160,145,86,132,173,219,173,192,197,196,39,194,624,84,0,142,227,197,40,125,212,72,60,572,264,0,646,546,144,196,196,75,286,165,189,125,645,60,125,277,166,0,193,0,100,189,189,645,135,138,149,84,189,0,166,217,272,0,624,543,624,51,0,0,244,77,188,274,171,149,244,571,624,624,194,192,60,624,142,546,277,125,51,624,149,212,142,77,86,624,194,75,252,135,98,51,193,193,75,219,193,543,244,225,194,72,75,145,144,571,624,624,51,256,211,624,193,256,158,252,156,219,272,217,274,546,84,145,219,274,125,156,0,210,125,252,189,324,156,646,138,142,75,173,280,132,264,169,624,72,192,624,0,171,555,0,248,0,171,318,227,75,324,192,125,264,218,276,72,197,39,189,248,277,149,244,73,156,0,276,98,217,286,166,0,205,0,0,90,543,73,187,84,313,61,0,205,173,72,98,75,129,171,286,646,256,270,100,197,572,142,98,132,197,193,264,0,225,274,280,197,0,192,169,171,211,169,219,124,132,645,166,187,136,0,75,274,90,324,124,51,86,555,0,86,171,75,88,589,0,274,90,0,0,156,255,202,0,280,51,219,280,518,149,518,218,212,51,219,255,211,124,197,211,51,274,51,572,51,173,264,264,125,51,77,219,39,255,219,72,171,156,149,125,255,132,274,136,156,518,51,274,0,274,158,197,0,166,0,51,51,219,77,189,136,219,196,219,274,572,136,255,39,136,51,274,274,311,244,252,272,205,88,132,51,173,646,591,125,571,196,217,591,187,194,572,192,156,219,0,0,313,645,589,192,156,244,132,86,546,192,197,0,0,173,0,77,546,591,196,591,192,40,646,40,572,40,124,196,591,40,572,0,0,280,61,270,192,518,189,86,624,196,248,158,40,318,158,171,274,0,61,0,193,276,39,0,645,264,0,196,274,0,244,187,84,277,40,171,286,39,248,75,149,192,276,189,132,156,158,202,318,40,0,132,166,0,189,0,225,125,138,0,166,166,518,173,132,212,272,192,51,156,256,0,192,187,591,196,0,158,624,196,156,75,256,0,166,0,189,197,196,196,132,225,132,166,98,77,86,86,264,89,132,227,244,202,193,276,645,86,142,212,75,142,132,88,589,646,211,158,244,166,313,274,142,546,75,0,256,51,270,135,518,135,646,248,156,0,646,225,77,149,39,571,225,0,256,218,256,144,646,0,311,572,264,571,248,555,73,173,132,538,98,189,138,197,51,73,0,0,135,187,0,75,138,572,196,276,86,84,196,192,244,138,189,197,538,197,248,244,138,274,555,149,318,77,145,73,0,624,538,276,77,572,270,274,169,280,280,276,0,264,280,196,0,173,311,138,219,138,225,276,187,276,135,192,72,98,149,0,538,0,276,248,248,286,173,39,188,135,189,156,156,86,34,158,73,264,252,135,145,0,145,518,197,244,0,73,624,77,187,219,166,646,166,217,624,125,196,0,646,125,125,0,124,98,217,73,98,624,270,538,124,187,142,125,276,77,0,149,125,149,624,188,187,272,0,197,51,538,0,518,132,217,0,61,125,192,173,125,0,624,34,189,313,144,646,173,538,125,166,196,144,158,546,34,248,144,212,98,624,188,156,272,0,132,145,39,518,211,286,124,270,73,156,244,0,313,149,518,189,624,189,0,72,252,518,591,518,624,186,218,188,78,645,0,72,0,98,75,0,0,34,144,274,124,518,84,173,518,212,252,274,34,144,0,188,645,173,142,173,546,158,518,518,166,0,270,518,219,264,225,188,624,0,277,193,171,518,194,192,72,51,256,156,196,145,211,286,646,142,173,77,60,313,276,173,149,51,518,124,156,60,189,244,145,98,277,173,189,186,193,186,188,132,572,166,274,194,0,173,188,276,100,272,244,189,51,543,277,194,543,264,73,60,225,546,274,286,187,518,244,0,192,248,169,311,217,252,47,61,186,188,264,73,225,192,192,196,196,645,72,75,324,244,264,646,51,518,192,196,205,324,86,132,546,646,276,0,186,125,0,196,264,135,205,324,145,90,646,276,192,77,272,192,196,624,280,192,86,193,543,142,171,77,98,86,98,624,124,169,156,72,124,188,518,225,77,98,98,248,264,277,0,286,225,276,0,173,205,132,189,98,591,125,166,138,75,205,156,188,248,86,324,0,0,205,324,189,196,132,166,217,156,217,324,227,193,98,193,276,248,0,77,192,646,132,132,0,518,272,211,646,624,90,90,39,90,252,193,156,135,171,270,197,157,156,194,187,173,211,98,187,77,166,227,189,90,86,0,0,73,88,572,189,75,142,211,313,90,217,189,276,313,248,205,72,193,591,0,543,227,171,276,169,39,256,276,272,274,166,138,196,77,276,518,645,645,145,187,75,646,192,272,192,196,313,0,286,276,0,51,0,624,0,158,645,47,84,156,248,39,518,197,132,145,75,61,256,98,166,72,124,187,280,280,61,61,98,0,252,192,217,73,0,132,270,129,189,75,646,188,624,192,0,286,169,61,0,272,0,158,0,270,192,264,193,252,272,274,255,196,270,0,72,132,624,276,219,274,129,86,518,624,72,75,132,40,270,0,135,40,572,61,555,40,252,61,61,173,589,280,132,132,244,264,0,189,217,189,169,132,252,211,86,61,286,255,189,217,196,132,591,78,193,51,0,572,169,270,0,189,276,144,132,125,252,132,142,202,77,77,196,189,270,0,132,646,136,187,277,277,158,225,286,169,189,171,286,124,311,196,124,277,75,571,646,88,124,277,61,132,211,546,166,211,39,277,546,189,591,124,0,197,86,264,264,276,51,518,546,193,255,311,276,248,277,189,244,311,61,225,173,132,311,145,0,171,225,572,311,546,276,158,77,244,0,142,256,313,75,211,132,311,311,256,0,136,132,256,546,166,51,318,158,192,86,646,197,276,264,197,75,256,313,313,248,244,88,272,39,218,187,624);

min_distance(\@n1_pocket);

sub min_distance{
	my $pdb_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/PDB/4B7R.pdb";
my $distance_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/4B7R_pocket_distances.txt";
open PDB, "<$pdb_file" or die "$!";

my %distance_hash;
my %d_hash;

while($line = <PDB>){
 	if ($line =~ /^ATOM\s+[0-9]+\s+CA\s/){
 		my @splitter = split (/\s+/, $line);
 		$distance_hash{$splitter[5].$splitter[4]} = [$splitter[6], $splitter[7], $splitter[8]];
 	#	print $splitter[6]."\t".$splitter[7]."\t".$splitter[8]."\n";
 		
 	}
			}
close PDB; 
	open DIST, ">$distance_file";	
	my @pocket = @{$_[0]};		
for (keys %distance_hash){
	my $key1 = $_;

	my $num1 = $key1;
	chop($num1);
	for (@pocket){
		my $dist = distance($distance_hash{$key1}, $distance_hash{$_."A"});
		#my $num2 = $_;

		if (exists $d_hash{$num1}){
			if ($dist < $d_hash{$num1}){
				$d_hash{$num1} = $dist;
			}
		}
		else {
			$d_hash{$num1} = $dist;
		}
	}
}


for (keys %d_hash){
	print DIST $_."\t".$d_hash{$_}."\n";
}
close DIST;
}


sub pairs_distance {
	
}

sub inter_distances {
	my $pdb_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/1RU7_mod.pdb";
my $distance_file = "C:/Users/weidewind/Documents/CMD/Coevolution/Influenza/1RU7_mod_distances.txt";
open PDB, "<$pdb_file";

my %distance_hash;
my %d_hash;

while($line = <PDB>){
 	if ($line =~ /^ATOM\s+[0-9]+\s+CA\s/){
 		my @splitter = split (/\s+/, $line);
 		$distance_hash{$splitter[5].$splitter[4]} = [$splitter[6], $splitter[7], $splitter[8]];
 	#	print $splitter[6]."\t".$splitter[7]."\t".$splitter[8]."\n";
 		
 	}
			}
close PDB; 
open DIST, ">$distance_file";			
for (keys %distance_hash){
	my $key1 = $_;
	my $num1 = $key1;
	chop($num1);
	for (keys %distance_hash){
		my $dist = distance($distance_hash{$key1}, $distance_hash{$_});
		my $num2 = $_;
		chop($num2);
	#	print $num1."\t".$num2."\n";
		if (exists $d_hash{$num1."_".$num2}){
		#	print $key1."\t".$_."\n";
			if ($dist < $d_hash{$num1."_".$num2}){
			#	print $key1."\t".$_."\t".$dist."\n";
				$d_hash{$num1."_".$num2} = $dist;
			}
		}
		else {
			$d_hash{$num1."_".$num2} = $dist;
		}
	 #print DIST $_."\t".$key1."\t".$dist."\n";
	}
}


for (keys %d_hash){
	print DIST $_."\t".$d_hash{$_}."\n";
}
close DIST;

}
 sub distance(){
 	
 	my @coord1 = @{$_[0]};
 	my @coord2 = @{$_[1]};
 #	print $coord1[0]."\t".$coord2[0]."\t".$coord1[1]."\t".$coord2[1]."\t".$coord1[2]."\t".$coord2[2]."\n";
 	my $dist = sqrt(($coord1[0] - $coord2[0])**2 + ($coord1[1] - $coord2[1])**2 + ($coord1[2] - $coord2[2])**2);
 #	print $dist."\n";
 	return $dist;
 	
 }